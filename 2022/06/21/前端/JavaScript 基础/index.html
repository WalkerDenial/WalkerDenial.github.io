<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  
  <meta name="keywords" content="Walker Denial">
  <meta name="description" content="This is Walker Denial&#39;s blog!">
  
  <title>Walker Denial</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/materialize.min.css">
    
      <link rel="stylesheet" href="/css/main.min.css">
    
  
  <style type="text/css">
      html{
          font-family: sans-serif;
          font-weight: 300;
      }
      @font-face {
          font-family: 'Material Icons';
          font-style: normal;
          font-weight: 400;
          src: url(/fonts/MaterialIcons-Regular.eot);
          src: url(/fonts/MaterialIcons-Regular.woff2) format('woff2'),
          url(/fonts/MaterialIcons-Regular.woff) format('woff'),
          url(/fonts/MaterialIcons-Regular.ttf) format('truetype')
      }
  </style>
<meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
<body>
<div id="menu-box"><a href="javascript:void(0)" id="menu" data-activates="slide-out" class="button-collapse menu" ><span class="nav-btn"></span></a></div>
<div id="menu-outer">
  <div id="menu-inner">
      <ul id="slide-out" class="side-nav" >
    <div class="nav-header"  style="background-image: url(/images/header-bg.png);background-color:#26A69A">
    <div class="header-box"><img src="/images/profile.png" ondragstart="return false;"></div>
    <p>Walker Denial</p>
    <div class="nav-link">
        
        <a href="https://twitter.com/WalkerDenial" target="_blank"> <div class="link-box twitter"></div></a>
        
        
        <a  href="https://github.com/WalkerDenial" target="_blank"><div class="link-box github"></div></a>
        
        
        <a href="mailto:mailto:WalkerDenial@gmail.com"><div class="link-box email"></div></a>
        
        
        <a href="http://weibo.com/u/3213135930" target="_blank"><div class="link-box weibo"></div></a>
        
        
        <a href="https://www.zhihu.com/people/walkerdenial/activities" target="_blank"> <div class="link-box zhihu"></div></a>
        
    </div>
    <div class="nav-search">
        <form id="search-form"> <!-- 搜索框相关 -->
            <input type="text" id="local-search-input" name="q" results="0" placeholder="搜索..." class="search form-control" autocomplete="off" autocorrect="off"/>
            <div class="nav-search-img"><i class="material-icons">search</i></div>
        </form>
        <div id="local-search-result"></div> <!-- 搜索结果区 -->
        <p class='no-result'>无搜索结果</p>
    </div>
</div>
    <!--Homepage-->

<li class="nav-list">
    <a href="/" target="_self">
        <div class="nav-ico"><i class="material-icons">home</i> </div><p>主页</p>
    </a>
</li>

<!--archives-->

<li class="nav-list dropdown-btn">
    <a  class=""  target="_self">
        <div class="nav-ico"><i class="material-icons">assignment</i></div><p>归档</p><div class="dropdown-ico"><i class="material-icons">arrow_drop_down</i></div>
    </a>
</li>

<ul class="dropdown-menu dropdown" >
    <li class="nav-dropdown-list">
        <a class="archive-link" href="/archives/2022/06/">June 2022<span class="archive-count">1</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2022/05/">May 2022<span class="archive-count">1</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2022/04/">April 2022<span class="archive-count">4</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2022/03/">March 2022<span class="archive-count">2</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/12/">December 2021<span class="archive-count">3</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/11/">November 2021<span class="archive-count">1</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/09/">September 2021<span class="archive-count">3</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/08/">August 2021<span class="archive-count">3</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/04/">April 2021<span class="archive-count">1</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/03/">March 2021<span class="archive-count">12</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/02/">February 2021<span class="archive-count">2</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2021/01/">January 2021<span class="archive-count">6</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2020/12/">December 2020<span class="archive-count">5</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2020/11/">November 2020<span class="archive-count">6</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2020/04/">April 2020<span class="archive-count">2</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2018/01/">January 2018<span class="archive-count">2</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2017/12/">December 2017<span class="archive-count">1</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2017/11/">November 2017<span class="archive-count">6</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2017/08/">August 2017<span class="archive-count">1</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2017/07/">July 2017<span class="archive-count">1</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2017/03/">March 2017<span class="archive-count">6</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2017/02/">February 2017<span class="archive-count">20</span></a></li><li class="nav-dropdown-list"><a class="archive-link" href="/archives/2017/01/">January 2017<span class="archive-count">2</span></a>
    </li>
</ul>
<!--categories-->

<li class="nav-list dropdown-btn">
    <a   class=""  target="_self">
        <div class="nav-ico"><i class="material-icons">dashboard</i></div><p>分类</p><div class="dropdown-ico"><i class="material-icons">arrow_drop_down</i></div>
    </a>
</li>

<ul class="dropdown-menu dropdown" >
    <li class="nav-dropdown-list">
        <a class="category-link" href="/categories/Algorithm/">Algorithm<span class="category-count">1</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/ES6/">ES6<span class="category-count">2</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/Flutter/">Flutter<span class="category-count">7</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/Gradle/">Gradle<span class="category-count">2</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/Java/">Java<span class="category-count">6</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/Kotlin/">Kotlin<span class="category-count">4</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/RPC/">RPC<span class="category-count">3</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/UML/">UML<span class="category-count">1</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E5%85%B6%E4%BB%96/">其他<span class="category-count">2</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E5%86%99%E4%BD%9C/">写作<span class="category-count">1</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端<span class="category-count">10</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统<span class="category-count">7</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E8%87%AA%E5%AD%A6/">自学<span class="category-count">9</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%BB%93%E6%9E%84/">计算机系统结构<span class="category-count">7</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络<span class="category-count">2</span></a></li><li class="nav-dropdown-list"><a class="category-link" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式<span class="category-count">27</span></a>
    </li>
</ul>
<!--tags-->

<li class="nav-list">
    <a href="/archives" target="_self">
        <div class="nav-ico"><i class="material-icons">bookmark</i> </div><p>标签</p>
    </a>
</li>

<!--photo-->

<!--friends-->

<!--about-->

<li class="nav-list">
    <a href="/about" target="_self">
        <div class="nav-ico"><i class="material-icons">copyright</i> </div><p>关于</p>
    </a>
</li>


</ul>

  </div>
</div>

<div id="content-outer">
  <div id="content-inner">
    
<article id="post">
  <div class="post-page-title"  style="background-color:#26A69A;background-image:url(/images/random/vateral-5.png)" >
  <h2>JavaScript 基础</h2>
    
  <p>作者 : Walker Denial &nbsp&nbsp 发布于 : <time datetime="2022-06-21T15:18:00.000Z">
          2022-06-21
    </time>
  </p>
    
  </div>
  <div class="post-page-content">
  <p>JavaScript（简称“JS”） 是一种具有函数优先的轻量级，解释型或即时编译型的 <strong>编程语言</strong>。虽然它是作为开发 <strong>Web</strong> 页面的 <strong>脚本语言</strong> 而出名，但是它也被用到了很多非浏览器环境中，JavaScript 基于原型编程、多范式的动态脚本语言，并且支持面向对象、命令式、声明式、函数式编程范式。</p>
<p>在日常使用 JavaScript 过程中，如果只是知其然，不知其所以然，就会导致项目出现各种非预期的问题，并且难以排查，所以，夯实 JavaScript 基础势在必行。</p>
<h2 id="数据类型容易忽略的细节"><a href="#数据类型容易忽略的细节" class="headerlink" title="数据类型容易忽略的细节"></a>数据类型容易忽略的细节</h2><h3 id="数据类型的陷阱，从表象看本质"><a href="#数据类型的陷阱，从表象看本质" class="headerlink" title="数据类型的陷阱，从表象看本质"></a>数据类型的陷阱，从表象看本质</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上述代码会不会有问题呢？当传值为 <code>null</code> 的时候，返回结果为 true。</p>
<p>追其原因，是早期 JavaScript 中，类型只有以下几种（数据总长度是 <strong>标记位 + 值</strong> 为 32 位）：</p>
<blockquote>
<p>000: object<br><br>001: integer<br><br>010: double<br><br>100: string<br><br>110: boolean</p>
</blockquote>
<p><code>null</code> 是一个特殊的值，为 <code>32 个 0 组成</code>。因此，开头标识为 <strong>0</strong>，也就对应 <strong>object</strong> 了。之所以不修复，是因为会涉及到很多项目，所以为了兼容性，没有进行修复，也就形成了历史的包袱。</p>
<h3 id="转为数字"><a href="#转为数字" class="headerlink" title="+ 转为数字"></a>+ 转为数字</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">toNumber</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token operator">+</span>val<span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// 传统数据类型</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// NaN</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span>undefined<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// NaN</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 1</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token string">"123aa"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// NaN</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// NaN</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// NaN</span>

<span class="token comment" spellcheck="true">// 非传统数据类型</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span>10n<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 错误，BigInt 不能转换为 number</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span>Symbol<span class="token punctuation">.</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 错误，Symbol 不能转换为 number</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="位移转为数字"><a href="#位移转为数字" class="headerlink" title="位移转为数字"></a>位移转为数字</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">toNumber</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> val <span class="token operator">></span><span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">toNumber2</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> val <span class="token operator">></span><span class="token operator">></span><span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// 正常数据类型</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 0</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 0</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token string">"10x"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 0</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span><span class="token string">"10"</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 10</span>

<span class="token comment" spellcheck="true">// 超大的数</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span>Number<span class="token punctuation">.</span>MAX_SAFE_INTEGER<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// -1</span>
<span class="token function">toNumber2</span><span class="token punctuation">(</span>Number<span class="token punctuation">.</span>MAX_SAFE_INTEGER<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 4294967295</span>

<span class="token comment" spellcheck="true">// 非传统数据类型</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span>10n<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 错误，BigInt 不能转换为 number</span>
<span class="token function">toNumber</span><span class="token punctuation">(</span>Symbol<span class="token punctuation">.</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 错误，Symbol 不能转换为 number</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>toNumber2(Number.MAX_SAFE_INTEGER) // 4294967295</code> 原因是什么呢？简单分析一下：</p>
<ol>
<li>Number.MAX_SAFE_INTEGER.toString(2) 值如下</li>
<li>11111111111111111111111111111111111111111111111111111</li>
<li>&gt;&gt;&gt; 的计算长度为 32 位(如果数据长度小于 32 位，则不会出现问题)，因此参与运算数据为</li>
<li>11111111111111111111111111111111</li>
<li>32位长度的值为 4294967295</li>
</ol>
<p><code>toNumber(Number.MAX_SAFE_INTEGER) // -1</code> 的原因又是什么呢？先补一个小知识：</p>
<blockquote>
<p>十进制变二进制：原码 =&gt; 反码 加一（补码）<br><br>二进制变十进制：减一 =&gt; 反码 = 原码</p>
</blockquote>
<p>进而分析原因：</p>
<ol>
<li>Number.MAX_SAFE_INTEGER.toString(2) 值如下</li>
<li>11111111111111111111111111111111111111111111111111111</li>
<li>&gt;&gt;&gt; 的计算长度为 32 位(如果数据长度小于 32 位，则不会出现问题)，因此参与运算数据为</li>
<li>11111111111111111111111111111111</li>
<li>减一</li>
<li>11111111111111111111111111111110</li>
<li>取反</li>
<li>00000000000000000000000000000001 = 1</li>
<li>最高位为 1，表示负数</li>
<li>所以结果为 -1</li>
</ol>
<h4 id="补充知识"><a href="#补充知识" class="headerlink" title="补充知识"></a>补充知识</h4><blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Left_shift">Left shift (&lt;&lt;)</a></p>
<blockquote>
<p>The left shift (&lt;&lt;) operator shifts the first operand the specified number of bits, <span style="color: red;">modulo 32</span>, to the left. Excess bits shifted off to the left are discarded. Zero bits are shifted in from the right.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Right_shift">Right shift (&gt;&gt;)</a></p>
<blockquote>
<p>The right shift (&gt;&gt;) operator returns the signed number represented by the result of performing a sign-extending shift of the binary representation of the first operand (evaluated as a two’s complement bit string) to the right by the number of bits, <span style="color: red;">modulo 32</span> specified in the second operand. Excess bits shifted off to the right are discarded, and copies of the leftmost bit are shifted in from the left.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Unsigned_right_shift">Unsigned right shift (&gt;&gt;&gt;)</a></p>
<blockquote>
<p>The unsigned right shift (&gt;&gt;&gt;) (zero-fill right shift) operator evaluates the left-hand operand as an unsigned number, and shifts the binary representation of that number by the number of bits, <span style="color: red;">modulo 32</span> specified by the right-hand operand. Excess bits shifted off to the right are discarded, and zero bits are shifted in from the left. The sign bit becomes 0, so the result is always non-negative. Unlike the other bitwise operators, zero-fill right shift returns an unsigned 32-bit integer.</p>
</blockquote>
</blockquote>
<h3 id="字符串批量转换为整数"><a href="#字符串批量转换为整数" class="headerlink" title="字符串批量转换为整数"></a>字符串批量转换为整数</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token string">"3"</span><span class="token punctuation">]</span>
arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>parseInt<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 1 NaN NaN</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>为什么没有按照预期输出呢？详细列出拆解代码即可知晓：</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => 1</span>
<span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => NaN，进制与值不匹配问题</span>
<span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => NaN，进制与值不匹配问题</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>parseInt(string)<br><br>parseInt(string, radix)</p>
<p><strong>string</strong>: The value to parse. If this argument is not a string, then it is converted to one using the ToString abstract operation. Leading whitespace in this argument is ignored.</p>
<p><strong>radix</strong>: An integer between <strong>2</strong> and <strong>36</strong> that represents the radix (the base in mathematical numeral systems) of the string. It is converted to a 32-bit integer; if it’s outside the range of [2, 36] after conversion, the function will always return NaN. If 0 or not provided, the radix will be inferred based on string’s value. Be careful — this does NOT always default to 10! The description below explains in more detail what happens when radix is not provided.</p>
<blockquote>
<p>The radix argument is converted to a number. If it’s unprovided, or if the value becomes 0, NaN or Infinity (undefined is coerced to NaN), JavaScript assumes the following:</p>
<blockquote>
<ol>
<li>If the input string, with leading whitespace and possible +/- signs removed, begins with 0x or 0X (a zero, followed by lowercase or uppercase X), radix is assumed to be 16 and the rest of the string is parsed as a hexadecimal number.</li>
<li>If the input string begins with any other value, the radix is 10 (decimal).</li>
</ol>
</blockquote>
</blockquote>
</blockquote>
<h3 id="if-条件判断"><a href="#if-条件判断" class="headerlink" title="if 条件判断"></a>if 条件判断</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result<span class="token punctuation">.</span>name <span class="token operator">=</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>问题点，<code>obj.name</code> 会转换为 <strong>boolean</strong>，像 <code>null</code>、<code>undefined</code>、<code>&#39;&#39;</code>、<code>false</code>、<code>0</code>、<code>-0</code>、<code>NaN</code> 会丢失数据。</p>
<p>解决方案：使用 <code>Object.hasOwnProperty(xxx)</code>。</p>
<h3 id="宽松比较"><a href="#宽松比较" class="headerlink" title="宽松比较"></a>宽松比较</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">null</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token comment" spellcheck="true">// false</span>
<span class="token string">'0'</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token comment" spellcheck="true">// true</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ol>
<li>NaN：与任何值都不相等，包括自身</li>
<li>BigInt、Symbol：要类型相同才进行后续</li>
<li>null、undefined：只能与 null、undefined 相等</li>
<li>布尔类型和其他类型的相等比较：布尔值转换为数字</li>
<li>数字类型和字符串类型的相等比较：会转换成数字</li>
<li>对象类型和原始类型的相等比较：对象转成原始数据类型</li>
<li>对象和对象的相等比较：比引用</li>
</ol>
<h3 id="typeof-与-instanceof-性能差距"><a href="#typeof-与-instanceof-性能差距" class="headerlink" title="typeof 与 instanceof 性能差距"></a>typeof 与 instanceof 性能差距</h3><p>在百万级别的调用中，typeof : instanceof ≈ 1 : 2</p>
<h3 id="null-和-undefined"><a href="#null-和-undefined" class="headerlink" title="null 和 undefined"></a>null 和 undefined</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> print <span class="token operator">=</span> console<span class="token punctuation">.</span>log<span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>global<span class="token punctuation">,</span> <span class="token string">'null'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// undefined</span>
<span class="token function">print</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyDescriptor</span><span class="token punctuation">(</span>global<span class="token punctuation">,</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// {value: undefined, writable: false, enumerable: false, configurable: false}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="数据类型-8-种判断方式"><a href="#数据类型-8-种判断方式" class="headerlink" title="数据类型 8 种判断方式"></a>数据类型 8 种判断方式</h3><h4 id="第一种：typeof"><a href="#第一种：typeof" class="headerlink" title="第一种：typeof"></a>第一种：typeof</h4><p>主要用途：操作数的类型，只能识别基础数据类型和引用类型</p>
<p>特别注意：</p>
<ol>
<li>typeof null =&gt; object</li>
<li>typeof NaN =&gt; number</li>
<li>typeof document.all =&gt; undefined</li>
</ol>
<p>注意事项：已经不是绝对安全（暂时性死区）</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">typeof</span> a
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="第二种：constructor"><a href="#第二种：constructor" class="headerlink" title="第二种：constructor"></a>第二种：constructor</h4><p>原理：constructor 指向创建实例对象的构造函数</p>
<p>注意事项：</p>
<ol>
<li>null 和 undefined</li>
<li>constructor 可以被改写</li>
</ol>
<h4 id="第三种：instanceof"><a href="#第三种：instanceof" class="headerlink" title="第三种：instanceof"></a>第三种：instanceof</h4><p>原理：原型链上查找，查到即是其实例</p>
<p>注意事项：</p>
<ol>
<li>右操作数必须是函数或者 class</li>
<li>多全局对象，例如多 window 之间</li>
</ol>
<h4 id="第四种：isPrototypeOf"><a href="#第四种：isPrototypeOf" class="headerlink" title="第四种：isPrototypeOf"></a>第四种：isPrototypeOf</h4><p>原理：是否出现在实例对象的原型链上</p>
<p>注意事项：<strong>能正常返回值</strong> 的情况，基本等同 instanceof</p>
<h4 id="第五种：Object-prototype-toString"><a href="#第五种：Object-prototype-toString" class="headerlink" title="第五种：Object.prototype.toString"></a>第五种：Object.prototype.toString</h4><p>原理：通过函数的动态 this 特性，返回其数据类型，示例 [object Date]</p>
<pre class="line-numbers language-javascript"><code class="language-javascript">Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// => [object Boolean]</span>

<span class="token comment" spellcheck="true">// 加上 toStringTag 属性，你的类也会有自定义的类型标签了</span>
<span class="token keyword">class</span> <span class="token class-name">ValidatorClass</span> <span class="token punctuation">{</span>
  <span class="token keyword">get</span> <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toStringTag<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">"Validator"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValidatorClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "[object Validator]"</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="第六种：鸭子类型检测（候选方案）"><a href="#第六种：鸭子类型检测（候选方案）" class="headerlink" title="第六种：鸭子类型检测（候选方案）"></a>第六种：鸭子类型检测（候选方案）</h4><p>原理：检查自身，属性的类型或者执行结果的类型。</p>
<p>示例：kindOf 与 p-is-promise</p>
<h4 id="第七种：Symbol-toStringTag"><a href="#第七种：Symbol-toStringTag" class="headerlink" title="第七种：Symbol.toStringTag"></a>第七种：Symbol.toStringTag</h4><p>原理：Object.prototype.toString 会读取该值。</p>
<p>适用场景：需自定义类型。</p>
<p>注意事项：兼容性。</p>
<h4 id="第八种：等比较"><a href="#第八种：等比较" class="headerlink" title="第八种：等比较"></a>第八种：等比较</h4><p>原理：与某个固定值进行比较。</p>
<p>适用场景：undefined、window、document、null 等。</p>
<table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">基础数据类型</th>
<th align="left">引用类型</th>
<th align="left">注意事项</th>
</tr>
</thead>
<tbody><tr>
<td align="left">typeof</td>
<td align="left">✅</td>
<td align="left">×</td>
<td align="left">NaN、object、document.all</td>
</tr>
<tr>
<td align="left">constructor</td>
<td align="left">✅部分</td>
<td align="left">✅</td>
<td align="left">可以被改写</td>
</tr>
<tr>
<td align="left">instanceof</td>
<td align="left">×</td>
<td align="left">✅</td>
<td align="left">多窗口，右边构造函数或者 class</td>
</tr>
<tr>
<td align="left">isPrototypeOf</td>
<td align="left">×</td>
<td align="left">✅</td>
<td align="left">小心 null 和 undefined</td>
</tr>
<tr>
<td align="left">toString</td>
<td align="left">✅</td>
<td align="left">✅</td>
<td align="left">小心内置原型</td>
</tr>
<tr>
<td align="left">鸭子类型</td>
<td align="left">—</td>
<td align="left">✅</td>
<td align="left">不得已或者兼容</td>
</tr>
<tr>
<td align="left">Symbol.toStringTag</td>
<td align="left">×</td>
<td align="left">✅</td>
<td align="left">识别自定义对象</td>
</tr>
<tr>
<td align="left">等比较</td>
<td align="left">✅</td>
<td align="left">✅</td>
<td align="left">特殊对象</td>
</tr>
</tbody></table>
<h3 id="NaN-和-Number-NaN"><a href="#NaN-和-Number-NaN" class="headerlink" title="NaN 和 Number.NaN"></a>NaN 和 Number.NaN</h3><p>特点：</p>
<ol>
<li>typeof NaN =&gt; ‘number’</li>
<li>NaN 与 NaN 不相等</li>
<li>不能被删除（ {configurable: false; enumerable: false; value: NaN; writable: false}）</li>
</ol>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">NaN</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
arr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => -1。indexOf 调用内部的 Number:: equal</span>
arr<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// => true。includes 调用内部的 Number::sameValueZero</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="数值千分位-6-种方法、性能大比拼"><a href="#数值千分位-6-种方法、性能大比拼" class="headerlink" title="数值千分位 6 种方法、性能大比拼"></a>数值千分位 6 种方法、性能大比拼</h3><table>
<thead>
<tr>
<th align="left">方法</th>
<th align="left">描述</th>
<th align="left">性能</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">数值转字符串遍历</td>
<td align="left">数字转字符串，整数部分低位往高位遍历</td>
<td align="left">T2</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">字符串 + substring 截取</td>
<td align="left">数字转字符串，整数部分高位往低位遍历，三位分组</td>
<td align="left">T2</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">除法 + 求模</td>
<td align="left">求模的值添加 「,」，求余的值（是否大于 1）计算是否结束</td>
<td align="left">T0</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">正则先行断言</td>
<td align="left">/\d{1,3}(?=(\d{3})+$)/g</td>
<td align="left">T2</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">Intl.NumberFormat</td>
<td align="left">new Intl.NumberFormat([locals[, options]])</td>
<td align="left">T2 或者下水道</td>
<td align="left">ECM-402 标准，初始化成本很大</td>
</tr>
<tr>
<td align="left">toLocalString</td>
<td align="left">把数字转为特定语言环境下的表示字符串，numObj.toLocalString([locals [, options]])</td>
<td align="left">T2 或者下水道</td>
<td align="left">设置小数位后性能变大非常大</td>
</tr>
</tbody></table>
<h3 id=""><a href="#" class="headerlink" title="[] + [], [] + {}, {} + [], {} + {}"></a>[] + [], [] + {}, {} + [], {} + {}</h3><h4 id="二元操作符-规则"><a href="#二元操作符-规则" class="headerlink" title="二元操作符 + 规则"></a>二元操作符 + 规则</h4><ul>
<li>如果操作数是对象，则对象会转换为原始值</li>
<li>如果其中一个操作数是字符串的话，另一个操作数也会转换成字符串，进行字符串连接</li>
<li>否则，两个操作数都将转换成数字或 NaN，进行加法操作</li>
</ul>
<pre class="line-numbers language-javascript"><code class="language-javascript">10n <span class="token operator">+</span> <span class="token number">10</span> <span class="token comment" spellcheck="true">// TypeError: cannot mix BigInt and other types</span>

Symbol<span class="token punctuation">.</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">10</span> <span class="token comment" spellcheck="true">// TypeError: Cannot convert a Symbol value to a number</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="对象转为原始数据类型的值"><a href="#对象转为原始数据类型的值" class="headerlink" title="对象转为原始数据类型的值"></a>对象转为原始数据类型的值</h4><ul>
<li> Symbol.toPrimitive</li>
<li> Object.prototype.valueOf</li>
<li> Object.prototype.toString</li>
</ul>
<h4 id="的原始值"><a href="#的原始值" class="headerlink" title="[] 的原始值"></a>[] 的原始值</h4><ul>
<li>typeof [][Symbol.toPrimitive] // undefined</li>
<li>[].valueOf() // []</li>
<li>[].toString() // ‘’</li>
</ul>
<h4 id="的原始值-1"><a href="#的原始值-1" class="headerlink" title="{} 的原始值"></a>{} 的原始值</h4><ul>
<li>typeof {}[Symbol.toPrimitive] // undefined</li>
<li>{}.valueOf() // {}</li>
<li>{}.toString() // ‘[object Object]’</li>
</ul>
<h4 id="-1"><a href="#-1" class="headerlink" title="[] + []"></a>[] + []</h4><ul>
<li>[].toString() + [].toString()</li>
<li>‘’ + ‘’</li>
<li>‘’</li>
</ul>
<h4 id="-2"><a href="#-2" class="headerlink" title="[] + {}"></a>[] + {}</h4><ul>
<li>[].toString() + {}.toString()</li>
<li>‘’ + ‘[object Object]’</li>
<li>‘[object Object]’</li>
</ul>
<h4 id="-3"><a href="#-3" class="headerlink" title="{} + []"></a>{} + []</h4><ul>
<li>等同于 {}; + []</li>
<li><ul>
<li>[]</li>
</ul>
</li>
<li><ul>
<li>‘’</li>
</ul>
</li>
<li>0</li>
</ul>
<h4 id="-4"><a href="#-4" class="headerlink" title="{} + {}"></a>{} + {}</h4><ul>
<li>Safari: “[object Object][object Object]”</li>
<li>Chrome: “[object Object][object Object]”</li>
<li>Edge: “[object Object][object Object]”</li>
</ul>
<p>可能出现情况：</p>
<ul>
<li>等同于 {}; + {}</li>
<li><ul>
<li>‘[object Object]’</li>
</ul>
</li>
<li>NaN</li>
</ul>
<h3 id="通过普通属性，排序属性和隐藏类提升对象属性认知"><a href="#通过普通属性，排序属性和隐藏类提升对象属性认知" class="headerlink" title="通过普通属性，排序属性和隐藏类提升对象属性认知"></a>通过普通属性，排序属性和隐藏类提升对象属性认知</h3><p>键的两种属性：</p>
<ol>
<li>字符串作为键（常规属性）：根据创建时的顺序进行排序</li>
<li>数字、数字字符串作为键（排序属性）：按照索引值大小升序排序</li>
</ol>
<p>守护隐藏类：</p>
<ol>
<li>初始化时保持属性顺序一致</li>
<li>一次性初始化完毕</li>
<li>谨慎使用 delete</li>
</ol>
<table>
<thead>
<tr>
<th align="center">方法</th>
<th align="center">新增属性</th>
<th align="center">修改描述符</th>
<th align="center">删除属性</th>
<th align="center">更改属性值</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Object.preventExtensions</td>
<td align="center">×</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">Object.seal</td>
<td align="center">×</td>
<td align="center">×（writable 有例外）</td>
<td align="center">×</td>
<td align="center">√</td>
</tr>
<tr>
<td align="center">Object.freeze</td>
<td align="center">×</td>
<td align="center">×（writable 有例外）</td>
<td align="center">×</td>
<td align="center">×</td>
</tr>
</tbody></table>
<h3 id="原型访问方式"><a href="#原型访问方式" class="headerlink" title="原型访问方式"></a>原型访问方式</h3><table>
<thead>
<tr>
<th align="center">方法</th>
<th align="left">作用</th>
<th align="left">重点和注意事项</th>
</tr>
</thead>
<tbody><tr>
<td align="center">prototype</td>
<td align="left">获取对象原型</td>
<td align="left">1、class ES6 转 ES5 基于 prototype<br>2、toString.call 的怪异现象</td>
</tr>
<tr>
<td align="center">__proto__</td>
<td align="left">构造函数的原型</td>
<td align="left">1、函数祖上第三代 __proto__ 是  null<br>2、普通对象祖上第二代 __proto__ 是 null</td>
</tr>
<tr>
<td align="center">instanceof</td>
<td align="left">构造函数（右侧）的 prototype 属性是否出现在某个实例对象（左侧）的原型链上</td>
<td align="left">1、Object instance of Function<br>2、Function instance Object</td>
</tr>
<tr>
<td align="center">getPrototype</td>
<td align="left">获取对象的原型</td>
<td align="left">null 和 undefined 没有原型</td>
</tr>
<tr>
<td align="center">setPrototype</td>
<td align="left">设置对象的原型</td>
<td align="left">null 可以作为第二个参数，原型的尽头是 null</td>
</tr>
<tr>
<td align="center">isPrototype</td>
<td align="left">对象是否存在于另一个对象的原型链上</td>
<td align="left">不会有 prototype 这一步运算</td>
</tr>
<tr>
<td align="center">Object.create</td>
<td align="left">使用现有的对象来提供新创建爱你的对象的 __proto__</td>
<td align="left">创建纯净对象</td>
</tr>
</tbody></table>
<h3 id="属性的类型及遍历"><a href="#属性的类型及遍历" class="headerlink" title="属性的类型及遍历"></a>属性的类型及遍历</h3><h4 id="属性的类型"><a href="#属性的类型" class="headerlink" title="属性的类型"></a>属性的类型</h4><ol>
<li>普通属性</li>
<li>不可枚举的属性</li>
<li>原型属性</li>
<li>Symbol 属性</li>
<li>静态属性</li>
</ol>
<h4 id="属性的遍历"><a href="#属性的遍历" class="headerlink" title="属性的遍历"></a>属性的遍历</h4><table>
<thead>
<tr>
<th align="left">方法名称</th>
<th align="center">普通属性</th>
<th align="center">不可枚举属性</th>
<th align="center">Symbol 属性</th>
<th align="center">原型属性</th>
</tr>
</thead>
<tbody><tr>
<td align="left">for in</td>
<td align="center">√</td>
<td align="center">×</td>
<td align="center">×</td>
<td align="center">√</td>
</tr>
<tr>
<td align="left">Object.keys</td>
<td align="center">√</td>
<td align="center">×</td>
<td align="center">×</td>
<td align="center">×</td>
</tr>
<tr>
<td align="left">Object.getOwnPropertyNames</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">×</td>
<td align="center">×</td>
</tr>
<tr>
<td align="left">Object.getOwnPropertySymbols</td>
<td align="center">×</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">×</td>
</tr>
<tr>
<td align="left">Reflect.getOwnKeys</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">×</td>
</tr>
</tbody></table>
<h4 id="获得原型上的所有属性"><a href="#获得原型上的所有属性" class="headerlink" title="获得原型上的所有属性"></a>获得原型上的所有属性</h4><p>递归 –&gt; 剔除内置属性</p>
<h4 id="获取不可枚举属性"><a href="#获取不可枚举属性" class="headerlink" title="获取不可枚举属性"></a>获取不可枚举属性</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">getNoEummerable</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> keys <span class="token operator">=</span> Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> keys<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span> key <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">!</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>propertyIsEmmerable<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="多种克隆方式"><a href="#多种克隆方式" class="headerlink" title="多种克隆方式"></a>多种克隆方式</h3><h4 id="浅克隆"><a href="#浅克隆" class="headerlink" title="浅克隆"></a>浅克隆</h4><h5 id="对象浅克隆"><a href="#对象浅克隆" class="headerlink" title="对象浅克隆"></a>对象浅克隆</h5><ol>
<li>ES6 的扩展运算符「…」</li>
<li>Object.assign</li>
<li>for in 和其他的一层遍历复制</li>
</ol>
<h5 id="数组浅克隆"><a href="#数组浅克隆" class="headerlink" title="数组浅克隆"></a>数组浅克隆</h5><ol>
<li>ES6 的扩展运算符「…」</li>
<li>slice</li>
<li>[].concat</li>
</ol>
<h4 id="深克隆"><a href="#深克隆" class="headerlink" title="深克隆"></a>深克隆</h4><ol>
<li><p>JSON.parse(JSON.stringify(xxxxxxxx))</p>
<ol>
<li>只能复制普通键的属性，Symbol类型的无能为力</li>
<li>循环引用对象，例如 window 不能复制（可参考使用 WeakMap 解决）</li>
<li>函数、Date、Regex、Blob等类型不能复制（可通过构造函数识别）</li>
<li>性能低</li>
<li>可能爆栈（循环代替递归）</li>
</ol>
</li>
<li><p>消息通讯-BroadcastChannel、window.postMessage、Shared Worker、Message Channel 等</p>
<ol>
<li>循环引用对象，例如 window 不能复制</li>
<li>函数不能复制</li>
<li>同步变异步</li>
</ol>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> chId <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    chId<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> cname <span class="token operator">=</span> <span class="token template-string"><span class="token string">`__clone__</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>chId<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> ch1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BroadcastChannel</span><span class="token punctuation">(</span>cname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> ch2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BroadcastChannel</span><span class="token punctuation">(</span>cname<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        ch2<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span> ev <span class="token operator">=</span><span class="token operator">></span> <span class="token function">resolve</span><span class="token punctuation">(</span>ev<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> once<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chi1<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>手写深度克隆</p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="left">深度克隆</th>
<th align="left">循环引用</th>
<th align="left">递归爆栈</th>
<th align="left">特殊类型</th>
</tr>
</thead>
<tbody><tr>
<td align="left">JSON 方式</td>
<td align="left">❌</td>
<td align="left">❌</td>
<td align="left">❌</td>
</tr>
<tr>
<td align="left">消息通讯方式</td>
<td align="left">❌</td>
<td align="left">❌</td>
<td align="left">✅（大部分）</td>
</tr>
<tr>
<td align="left">手写方式</td>
<td align="left">✅</td>
<td align="left">✅</td>
<td align="left">✅</td>
</tr>
</tbody></table>

  </div>
  <!--评论块-->
    

</article>
<nav class="post-nav">
  <!-- Prev Nav -->
    


  <!-- Next Nav -->
    
  <a href="/2022/05/02/前端/CSS 动画/" id="post_nav-older" class="post-nav-content next-content">
      下一篇>
  </a>
    
</nav>
<div class="post-toc-btn"><i class="material-icons">format_list_numbered</i></div>
<div class="post-toc-none"><p>(无)</p></div>
<div class="post-toc-box">
    <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AE%B9%E6%98%93%E5%BF%BD%E7%95%A5%E7%9A%84%E7%BB%86%E8%8A%82"><span class="post-toc-text">数据类型容易忽略的细节</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%99%B7%E9%98%B1%EF%BC%8C%E4%BB%8E%E8%A1%A8%E8%B1%A1%E7%9C%8B%E6%9C%AC%E8%B4%A8"><span class="post-toc-text">数据类型的陷阱，从表象看本质</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%BD%AC%E4%B8%BA%E6%95%B0%E5%AD%97"><span class="post-toc-text">+ 转为数字</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BD%8D%E7%A7%BB%E8%BD%AC%E4%B8%BA%E6%95%B0%E5%AD%97"><span class="post-toc-text">位移转为数字</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%A1%A5%E5%85%85%E7%9F%A5%E8%AF%86"><span class="post-toc-text">补充知识</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%89%B9%E9%87%8F%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%95%B4%E6%95%B0"><span class="post-toc-text">字符串批量转换为整数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#if-%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="post-toc-text">if 条件判断</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%BD%E6%9D%BE%E6%AF%94%E8%BE%83"><span class="post-toc-text">宽松比较</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#typeof-%E4%B8%8E-instanceof-%E6%80%A7%E8%83%BD%E5%B7%AE%E8%B7%9D"><span class="post-toc-text">typeof 与 instanceof 性能差距</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#null-%E5%92%8C-undefined"><span class="post-toc-text">null 和 undefined</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B-8-%E7%A7%8D%E5%88%A4%E6%96%AD%E6%96%B9%E5%BC%8F"><span class="post-toc-text">数据类型 8 种判断方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%EF%BC%9Atypeof"><span class="post-toc-text">第一种：typeof</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%EF%BC%9Aconstructor"><span class="post-toc-text">第二种：constructor</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E4%B8%89%E7%A7%8D%EF%BC%9Ainstanceof"><span class="post-toc-text">第三种：instanceof</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E5%9B%9B%E7%A7%8D%EF%BC%9AisPrototypeOf"><span class="post-toc-text">第四种：isPrototypeOf</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E4%BA%94%E7%A7%8D%EF%BC%9AObject-prototype-toString"><span class="post-toc-text">第五种：Object.prototype.toString</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E5%85%AD%E7%A7%8D%EF%BC%9A%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%B5%8B%EF%BC%88%E5%80%99%E9%80%89%E6%96%B9%E6%A1%88%EF%BC%89"><span class="post-toc-text">第六种：鸭子类型检测（候选方案）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E4%B8%83%E7%A7%8D%EF%BC%9ASymbol-toStringTag"><span class="post-toc-text">第七种：Symbol.toStringTag</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E5%85%AB%E7%A7%8D%EF%BC%9A%E7%AD%89%E6%AF%94%E8%BE%83"><span class="post-toc-text">第八种：等比较</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#NaN-%E5%92%8C-Number-NaN"><span class="post-toc-text">NaN 和 Number.NaN</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%95%B0%E5%80%BC%E5%8D%83%E5%88%86%E4%BD%8D-6-%E7%A7%8D%E6%96%B9%E6%B3%95%E3%80%81%E6%80%A7%E8%83%BD%E5%A4%A7%E6%AF%94%E6%8B%BC"><span class="post-toc-text">数值千分位 6 种方法、性能大比拼</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-text">[] + [], [] + {}, {} + [], {} + {}</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E4%BA%8C%E5%85%83%E6%93%8D%E4%BD%9C%E7%AC%A6-%E8%A7%84%E5%88%99"><span class="post-toc-text">二元操作符 + 规则</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%AF%B9%E8%B1%A1%E8%BD%AC%E4%B8%BA%E5%8E%9F%E5%A7%8B%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%80%BC"><span class="post-toc-text">对象转为原始数据类型的值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%9A%84%E5%8E%9F%E5%A7%8B%E5%80%BC"><span class="post-toc-text">[] 的原始值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%9A%84%E5%8E%9F%E5%A7%8B%E5%80%BC-1"><span class="post-toc-text">{} 的原始值</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#-1"><span class="post-toc-text">[] + []</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#-2"><span class="post-toc-text">[] + {}</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#-3"><span class="post-toc-text">{} + []</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#-4"><span class="post-toc-text">{} + {}</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%80%9A%E8%BF%87%E6%99%AE%E9%80%9A%E5%B1%9E%E6%80%A7%EF%BC%8C%E6%8E%92%E5%BA%8F%E5%B1%9E%E6%80%A7%E5%92%8C%E9%9A%90%E8%97%8F%E7%B1%BB%E6%8F%90%E5%8D%87%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E8%AE%A4%E7%9F%A5"><span class="post-toc-text">通过普通属性，排序属性和隐藏类提升对象属性认知</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8E%9F%E5%9E%8B%E8%AE%BF%E9%97%AE%E6%96%B9%E5%BC%8F"><span class="post-toc-text">原型访问方式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%8F%8A%E9%81%8D%E5%8E%86"><span class="post-toc-text">属性的类型及遍历</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="post-toc-text">属性的类型</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%B1%9E%E6%80%A7%E7%9A%84%E9%81%8D%E5%8E%86"><span class="post-toc-text">属性的遍历</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%8E%B7%E5%BE%97%E5%8E%9F%E5%9E%8B%E4%B8%8A%E7%9A%84%E6%89%80%E6%9C%89%E5%B1%9E%E6%80%A7"><span class="post-toc-text">获得原型上的所有属性</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%8D%E5%8F%AF%E6%9E%9A%E4%B8%BE%E5%B1%9E%E6%80%A7"><span class="post-toc-text">获取不可枚举属性</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A4%9A%E7%A7%8D%E5%85%8B%E9%9A%86%E6%96%B9%E5%BC%8F"><span class="post-toc-text">多种克隆方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%B5%85%E5%85%8B%E9%9A%86"><span class="post-toc-text">浅克隆</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E5%AF%B9%E8%B1%A1%E6%B5%85%E5%85%8B%E9%9A%86"><span class="post-toc-text">对象浅克隆</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E6%95%B0%E7%BB%84%E6%B5%85%E5%85%8B%E9%9A%86"><span class="post-toc-text">数组浅克隆</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%B7%B1%E5%85%8B%E9%9A%86"><span class="post-toc-text">深克隆</span></a></li></ol></li></ol></li></ol>
</div>
<!--<div class="post-back"><i class="material-icons">arrow_back</i></div>-->
<script type="text/javascript">
    menu();
</script>
  </div>
</div>
<div id="bottom-outer">
  <div id="bottom-inner">
    <a  id="top-button" onfocus="this.blur();"><div class="up upinbody" style="background-color:#26A69A"><i class="material-icons material-up">vertical_align_top</i></div></a>


<p >Copyright ©  2017  Walker Denial</p>
<!-- <p >Powered by <a href="https://hexo.io/" target="_blank"> Hexo </a> & Theme - <a href="https://github.com/moumao/hexo-theme-Vateral" target="_blank">Vateral</a></p> -->
<p style="font-size: 10px; margin-top: 0" id="footer-times" data-time="01/10/2017 00:00:00"></p>
<script>
    var beginTime=document.getElementById("footer-times").dataset.time
    function show_date_time(){
        var span=document.getElementById("footer-times")
        window.setTimeout("show_date_time()", 1000);
        BirthDay=new Date(beginTime);//初始日期
        today=new Date();
        timeold=(today.getTime()-BirthDay.getTime());
        sectimeold=timeold/1000
        secondsold=Math.floor(sectimeold);
        msPerDay=24*60*60*1000
        e_daysold=timeold/msPerDay
        daysold=Math.floor(e_daysold);
        e_hrsold=(e_daysold-daysold)*24;
        hrsold=Math.floor(e_hrsold);
        e_minsold=(e_hrsold-hrsold)*60;
        minsold=Math.floor((e_hrsold-hrsold)*60);
        seconds=Math.floor((e_minsold-minsold)*60);
        span.innerHTML="本站已运行"+daysold+"天"+hrsold+"小时"+minsold+"分"+seconds+"秒";
    }
    show_date_time();
</script>

  </div>
</div>

<!--影集界面需要的资源-->



<!-- scripts list from theme config.yml -->

<script src="/js/jquery-3.1.1.min.js"></script>

<script src="/js/materialize.min.js"></script>

<script src="/js/main.min.js"></script>


<script>
    NProgress.start();
    NProgress.done();
    lazy();
    links();
    window.onpopstate = menu();
    //pjax操作
    $(document).pjax('a:not(.nopjax)', '#content-inner', {fragment:'#content-inner', timeout:8000});
    $(document).on('pjax:start', NProgress.start).on('pjax:end', NProgress.done)
        .on('pjax:end', () => {
            dowmdiv();
            lazy();
            toc();
            links();
            menu();
        });
</script>

</body>
</html>
